<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaito 影响力排行榜 - 演示版</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .app-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 20px;
            text-align: center;
        }

        .app-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
        }

        .logo {
            font-size: 3.5rem;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .app-description {
            font-size: 1.3rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .controls-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .control-group {
            display: flex;
            flex-direction: column;
            min-width: 150px;
        }

        .control-group label {
            color: white;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .control-select {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-select:hover {
            background: white;
            transform: translateY(-1px);
        }

        .leaderboard-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .leaderboard-header h2 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .users-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 24px;
        }

        .user-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            position: relative;
            border: 1px solid #f0f0f0;
        }

        .user-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 40px rgba(0, 0, 0, 0.12);
        }

        .rank-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(238, 90, 36, 0.3);
        }

        .user-card:nth-child(1) .rank-badge {
            background: linear-gradient(135deg, #ffd700, #ffb347);
        }

        .user-card:nth-child(2) .rank-badge {
            background: linear-gradient(135deg, #c0c0c0, #a8a8a8);
        }

        .user-card:nth-child(3) .rank-badge {
            background: linear-gradient(135deg, #cd7f32, #b8860b);
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            margin: 0 auto 16px;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #f0f0f0;
        }

        .user-info {
            text-align: center;
            margin-bottom: 20px;
        }

        .user-name {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin: 0 0 4px 0;
        }

        .user-username {
            color: #666;
            font-size: 0.9rem;
            margin: 0 0 8px 0;
        }

        .user-bio {
            color: #888;
            font-size: 0.85rem;
            line-height: 1.4;
            margin: 0;
        }

        .user-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            margin-bottom: 20px;
            gap: 12px;
        }

        .stat-item {
            text-align: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .stat-label {
            display: block;
            font-size: 0.75rem;
            color: #666;
            text-transform: uppercase;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .stat-value {
            display: block;
            font-size: 1.1rem;
            font-weight: 700;
            color: #333;
        }

        .mindshare-score {
            color: #667eea;
        }

        .twitter-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: #1da1f2;
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .twitter-link:hover {
            background: #0d8bd9;
            transform: translateY(-1px);
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            font-size: 1.2rem;
            color: #666;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .app-footer {
            background: #2d3748;
            color: #a0aec0;
            text-align: center;
            padding: 24px 20px;
            font-size: 0.9rem;
        }

        .app-footer a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .app-title {
                font-size: 2rem;
                flex-direction: column;
                gap: 8px;
            }
            
            .users-grid {
                grid-template-columns: 1fr;
            }
            
            .controls-section {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header class="app-header">
        <h1 class="app-title">
            <span class="logo">🚀</span>
            Kaito 影响力排行榜
        </h1>
        <p class="app-description">
            发现加密货币领域最具影响力的 KOL 和思想领袖
        </p>
    </header>

    <main class="container">
        <div class="controls-section">
            <div class="control-group">
                <label for="category-select">项目分类:</label>
                <select id="category-select" class="control-select">
                    <option value="post_tge">Post TGE 项目</option>
                    <option value="pre_tge">Pre TGE 项目</option>
                </select>
            </div>
            <div class="control-group">
                <label for="topic-select">项目/代币:</label>
                <select id="topic-select" class="control-select">
                    <option value="APT">APT</option>
                    <option value="ARB">ARB</option>
                    <option value="BERA">BERA</option>
                    <option value="DYDX">DYDX</option>
                    <option value="FUEL">FUEL</option>
                    <option value="INJ">INJ</option>
                    <option value="NEAR">NEAR</option>
                    <option value="SEI">SEI</option>
                </select>
            </div>
            <div class="control-group">
                <label for="duration-select">时间范围:</label>
                <select id="duration-select" class="control-select">
                    <option value="7d">7 天</option>
                    <option value="30d">30 天</option>
                    <option value="3m">3 个月</option>
                    <option value="6m">6 个月</option>
                    <option value="12m">12 个月</option>
                </select>
            </div>
            <div class="control-group">
                <label for="top-n-select">显示数量:</label>
                <select id="top-n-select" class="control-select">
                    <option value="10">Top 10</option>
                    <option value="25">Top 25</option>
                    <option value="50">Top 50</option>
                    <option value="100">Top 100</option>
                </select>
            </div>
        </div>

        <div class="leaderboard-header">
            <h2 id="leaderboard-title">🏆 APT 影响力排行榜</h2>
            <p class="subtitle" id="leaderboard-subtitle">Post TGE 项目 - 显示过去 7 天 的前 10 名影响者</p>
        </div>

        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <p>正在加载排行榜数据...</p>
        </div>
        <div id="users-grid" class="users-grid" style="display: none;"></div>
    </main>

    <footer class="app-footer">
        <p>
            数据来源: <a href="https://yaps.kaito.ai/yapper-leaderboards" target="_blank" rel="noopener noreferrer">Kaito AI</a>
        </p>
    </footer>

    <script>
        // 项目分类数据
        const projectCategories = {
            'pre_tge': {
                label: 'Pre TGE 项目',
                topics: ["0G", "ALLORA", "ANOMA", "BLS", "BOUNDLESS", "CAMP", "CYSIC", "FOGO", "HANAHANA",
                        "GOATNETWORK", "INFINEX", "INFINIT", "IRYS", "KAT", "LOMBARD", "LUMITERRA", "MEGAETH",
                        "MEMEX", "MIRA", "MITOSIS", "MONAD", "MULTIBANK", "MULTIPLI", "NYT", "NOYA",
                        "OPENLEDGER", "PARADEX", "PORTALPORTAL", "PUFFPAW", "SATLAYER", "SIDEKICK", "SOMNIA",
                        "SO", "SUCCINCT", "SURF", "SYMPHONY", "THEORIQ", "THRIVE", "TURTLECLUB", "UNION",
                        "WARP", "YEET"]
            },
            'post_tge': {
                label: 'Post TGE 项目',
                topics: ["KAITO", "ANIME", "APT", "ARB", "BERA", "BOOPBOOPFUN", "BYBITTRADFI", "CALDERA",
                        "CORN", "CREATORBID", "DEFIAPP", "DYDX", "ECLIPSE", "FRAX", "FUEL", "HUMAFINANCE",
                        "HUMANITY", "INITIA", "INJ", "IQ", "KAIA", "KINTO", "MNT", "MAPLESTORYUNIVERSE",
                        "MOVEMENT", "NEAR", "NEWTON", "ORDERLYNETWORK", "PEAQ", "PENGU", "DOT", "PYTH",
                        "QUAI", "SEI", "SKATE", "S", "SOON", "SOPHON", "STARKNET", "STORYPROTOCOL",
                        "UXLINK", "VIRTUALECOSYSTEM", "WAYFINDER", "XION", "ZEC"]
            }
        };

        // 生成不同项目的模拟数据
        function generateMockData(topic, count = 10) {
            const names = [
                'Vitalik Buterin', 'Changpeng Zhao', 'Elon Musk', 'Michael Saylor',
                'Cathie Wood', 'Anthony Pompliano', 'Andreas Antonopoulos', 'Naval Ravikant',
                'Balaji Srinivasan', 'Lex Fridman', 'Tim Draper', 'Barry Silbert',
                'Cameron Winklevoss', 'Tyler Winklevoss', 'Brian Armstrong', 'Gavin Wood',
                'Charles Hoskinson', 'Dan Larimer', 'Justin Sun', 'Roger Ver',
                'Erik Voorhees', 'Tone Vays', 'Max Keiser', 'Stacy Herbert',
                'Preston Pysh', 'Robert Kiyosaki', 'Peter Schiff', 'Raoul Pal'
            ];

            return Array.from({ length: count }, (_, index) => ({
                user_id: `${topic}-user-${index}`,
                name: names[index % names.length] || `${topic} Expert ${index + 1}`,
                username: `${topic.toLowerCase()}expert${index + 1}`,
                icon: `https://ui-avatars.com/api/?name=${encodeURIComponent(names[index % names.length] || `${topic} Expert ${index + 1}`)}&background=random`,
                bio: `${topic} enthusiast and thought leader in the crypto space. Passionate about blockchain technology.`,
                following_count: Math.floor(Math.random() * 5000) + 500,
                follower_count: Math.floor(Math.random() * 100000) + 10000,
                smart_follower_count: Math.floor(Math.random() * 50) + 5,
                mindshare: Math.random() * 0.1,
                rank: index + 1,
                twitter_user_url: `https://x.com/${topic.toLowerCase()}expert${index + 1}`
            }));
        }

        // 当前显示的数据
        let currentData = [];

        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        function renderUsers(users) {
            const grid = document.getElementById('users-grid');
            const loading = document.getElementById('loading');

            // 重置加载状态的内容（如果之前显示了错误信息）
            loading.innerHTML = '<div class="loading-spinner"></div><p>正在加载排行榜数据...</p>';
            loading.style.display = 'none';
            grid.style.display = 'grid';
            
            grid.innerHTML = users.map((user, index) => `
                <div class="user-card">
                    <div class="rank-badge">#${user.rank}</div>
                    
                    <div class="user-avatar">
                        <img src="${user.icon}" alt="${user.name}" 
                             onerror="this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(user.name)}&background=random'">
                    </div>

                    <div class="user-info">
                        <h3 class="user-name">${user.name}</h3>
                        <p class="user-username">@${user.username}</p>
                        <p class="user-bio">${user.bio}</p>
                    </div>

                    <div class="user-stats">
                        <div class="stat-item">
                            <span class="stat-label">影响力分数</span>
                            <span class="stat-value mindshare-score">${(user.mindshare * 100).toFixed(2)}%</span>
                        </div>
                        
                        <div class="stat-item">
                            <span class="stat-label">粉丝数</span>
                            <span class="stat-value">${formatNumber(user.follower_count)}</span>
                        </div>

                        <div class="stat-item">
                            <span class="stat-label">关注数</span>
                            <span class="stat-value">${formatNumber(user.following_count)}</span>
                        </div>

                        <div class="stat-item">
                            <span class="stat-label">智能粉丝</span>
                            <span class="stat-value">${formatNumber(user.smart_follower_count)}</span>
                        </div>
                    </div>

                    <div class="user-actions">
                        <a href="${user.twitter_user_url}" target="_blank" rel="noopener noreferrer" class="twitter-link">
                            🐦 Twitter
                        </a>
                    </div>
                </div>
            `).join('');
        }

        // 更新项目选择器
        function updateTopicSelect(category) {
            const topicSelect = document.getElementById('topic-select');
            const topics = projectCategories[category].topics;

            topicSelect.innerHTML = '';
            topics.forEach(topic => {
                const option = document.createElement('option');
                option.value = topic;
                option.textContent = topic;
                topicSelect.appendChild(option);
            });
        }

        // 调用真实的 Kaito API
        async function fetchKaitoData(duration, topic_id, top_n) {
            const url = "https://hub.kaito.ai/api/v1/gateway/ai/kol/mindshare/top-leaderboard";
            const params = new URLSearchParams({
                duration: duration,
                topic_id: topic_id,
                top_n: top_n.toString()
            });

            try {
                const response = await fetch(`${url}?${params}`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();

                // 处理 API 返回的数据，确保格式正确
                if (Array.isArray(data)) {
                    return data.map((user, index) => ({
                        user_id: user.user_id || `user-${index}`,
                        name: user.name || 'Unknown User',
                        username: user.username || '',
                        icon: user.icon || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.name || 'User')}&background=random`,
                        bio: user.bio || '',
                        following_count: user.following_count || 0,
                        follower_count: user.follower_count || 0,
                        smart_follower_count: user.smart_follower_count || 0,
                        mindshare: user.mindshare || 0,
                        rank: user.rank || (index + 1),
                        twitter_user_url: user.twitter_user_url || '#'
                    }));
                } else {
                    console.warn('Unexpected API response format:', data);
                    return generateMockData(topic_id, top_n);
                }
            } catch (error) {
                console.error('Error fetching Kaito data:', error);
                // 如果 API 调用失败，使用模拟数据
                return generateMockData(topic_id, top_n);
            }
        }

        // 加载数据
        async function loadData() {
            const category = document.getElementById('category-select').value;
            const topic = document.getElementById('topic-select').value;
            const duration = document.getElementById('duration-select').value;
            const topN = parseInt(document.getElementById('top-n-select').value);

            // 显示加载状态
            document.getElementById('loading').style.display = 'block';
            document.getElementById('users-grid').style.display = 'none';

            try {
                // 调用真实的 Kaito API
                currentData = await fetchKaitoData(duration, topic, topN);
                renderUsers(currentData);
                updateLabels();
            } catch (error) {
                console.error('Failed to load data:', error);
                // 如果出错，显示错误信息
                document.getElementById('loading').innerHTML = '<p style="color: red;">加载数据失败，请稍后重试</p>';
            }
        }

        // 更新标题和副标题
        function updateLabels() {
            const category = document.getElementById('category-select').value;
            const topic = document.getElementById('topic-select').value;
            const duration = document.getElementById('duration-select').value;
            const topN = document.getElementById('top-n-select').value;

            const durationLabels = {
                '7d': '7 天',
                '30d': '30 天',
                '3m': '3 个月',
                '6m': '6 个月',
                '12m': '12 个月'
            };

            document.getElementById('leaderboard-title').textContent = `🏆 ${topic} 影响力排行榜`;
            document.getElementById('leaderboard-subtitle').textContent =
                `${projectCategories[category].label} - 显示过去 ${durationLabels[duration]} 的前 ${topN} 名影响者`;
        }

        // 添加控制器事件监听
        document.getElementById('category-select').addEventListener('change', function() {
            updateTopicSelect(this.value);
            loadData();
        });

        document.getElementById('topic-select').addEventListener('change', loadData);
        document.getElementById('duration-select').addEventListener('change', loadData);
        document.getElementById('top-n-select').addEventListener('change', loadData);

        // 初始化
        updateTopicSelect('post_tge');
        loadData();
    </script>
</body>
</html>
